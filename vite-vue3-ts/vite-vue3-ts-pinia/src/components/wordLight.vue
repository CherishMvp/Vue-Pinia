<template>
  <div>
    <!-- 搜索框 -->
    <section>
      <input v-model="value" />
      <span>
        当前要标红的关键字：<b>{{ value }}</b></span
      >
    </section>
    <!-- END -->

    <!-- 列表 -->
    <section v-for="(item, index) in list" :key="index" class="content">
      <div>
        <span v-html="keySign(item.content)"></span>
      </div>
      <hr />
    </section>
    <!-- END -->
  </div>
</template>

<script setup lang="ts">
  import { ref } from 'vue';
  const handleStatus = ref(false);
  const value = ref('');
  // 模拟假数据列表
  const list = ref([
    {
      _id: '1598233286995447808',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '12312',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669883484015,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '16:31:24',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598233121551126528',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '12321',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669883444570,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '16:30:44',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598147968095064064',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/account.png',
      content: '2131',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669863142404,
      senderId: '1595761753823744000',
      system: false,
      timestamp: '10:52:22',
      userId: [],
      username: '许建国',
    },
    {
      _id: '1598147455257513984',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/account.png',
      content: '111',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669863020134,
      senderId: '1595761753823744000',
      system: false,
      timestamp: '10:50:20',
      userId: [],
      username: '许建国',
    },
    {
      _id: '1598147447284142080',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/account.png',
      content: '213123',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669863018233,
      senderId: '1595761753823744000',
      system: false,
      timestamp: '10:50:18',
      userId: [],
      username: '许建国',
    },
    {
      _id: '1598146205384282112',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/account.png',
      content: '123213',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669862722141,
      senderId: '1595761753823744000',
      system: false,
      timestamp: '10:45:22',
      userId: [],
      username: '许建国',
    },
    {
      _id: '1598145948831289344',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/account.png',
      content: '123123',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669862660974,
      senderId: '1595761753823744000',
      system: false,
      timestamp: '10:44:20',
      userId: [],
      username: '许建国',
    },
    {
      _id: '1598141657236213760',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '111',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861637778,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:27:17',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598141640102481920',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '123213',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861633693,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:27:13',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598141588852281344',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '2`12`',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861621474,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:27:01',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598141570460258304',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '213123',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861617089,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:26:57',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140899841380352',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '123123',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861457201,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:24:17',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140882560847872',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '12313',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861453081,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:24:13',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140859118882816',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '1',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861447492,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:24:07',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140852718374912',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '12313',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861445966,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:24:05',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140821596639232',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '213',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861438546,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:23:58',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140813795233792',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '111',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861436686,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:23:56',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140805113024512',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '312312',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861434616,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:23:54',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140795617120256',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '11',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861432352,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:23:52',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598140784040841216',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '123213',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861429592,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:23:49',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598139556577775616',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '312313',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861136942,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:18:56',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598139545735499776',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '11',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861134357,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:18:54',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598139532653465600',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '1123',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861131238,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:18:51',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598139518803873792',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '213123',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861127936,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:18:47',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598139114837872640',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '@许建国 111',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861031623,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:17:11',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1598139086396297216',
      announcement: false,
      avatar: 'https://im.yihaidata.com/tim/20221128/1597138551295807488.png',
      content: '123213',
      currentUserId: '1597138653347418112',
      date: '2022-12-01',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669861024842,
      senderId: '1597138653347418112',
      system: false,
      timestamp: '10:17:04',
      userId: [],
      username: 'Lincj邮箱',
    },
    {
      _id: '1597522389343768576',
      avatar: 'https://im.yihaidata.com/tim/account.png',
      content: '1',
      currentUserId: '1597138653347418112',
      date: '2022-11-29',
      deleted: false,
      distributed: true,
      roomId: '1597518131860967424',
      saved: true,
      seen: false,
      sendTime: 1669713992807,
      senderId: '1595761753823744000',
      system: false,
      timestamp: '17:26:32',
      userId: [],
      username: '许建国',
    },
  ]);

  /**
   * 标红关键字
   * @description 可自定义HTML结构
   * @param {String} title - 列表标题
   * @return void
   */
  function keySign(title: any) {
    let s = value.value; // 搜索框的值(您要标红的关键字)
    var str = title; // 列表标题(原文本)

    // 去除中间空格且字符之间用逗号隔开
    let inputvalue = s.replace(/\ +/g, ','); // 把空格分开的字符串转换成以逗号分割
    let keyWordArr2 = inputvalue.split(','); // 把字符串分割转换成数组(方便截取)
    // 判断文本段落(原文本)是否为空
    if (str && str != '') {
      // 遍历分割后的字符串
      keyWordArr2.forEach((e) => {
        let regStr = '' + `(${e})`;
        let reg = new RegExp(regStr, 'g');
        // 如果匹配成功则抛出关键字DOM
        // TIPS: 这块您可以自定义标签可根据您的需求自定义样式
        str = str.replace(reg, '<span style="color:#fff;font-weight: bold;background-color: red;">' + e + '</span>'); // 改变搜索关键字颜色为红色
      });
    }
    return str;
  }
</script>

<style scoped>
  .content {
    background: rgb(169, 186, 202);
    padding: 10px;
    margin-bottom: 20px;
    margin-top: 10px;
  }
</style>
